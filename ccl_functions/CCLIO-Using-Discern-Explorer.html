
<!DOCTYPE html>

<html lang="en-US">
<head>
<!-- Start SiteCatalyst code --><!-- End SiteCatalyst code -->


<title>CCLIO( ) Using Discern Explorer - Discern Help Pages - Cerner Wiki</title>






























<style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>



</head>
<body class="theme-default aui-layout aui-theme-default" id="com-atlassian-confluence">
<div id="stp-licenseStatus-banner"></div>
<div id="workflow-page-status" style="display: none;"><fieldset class="hidden parameters">
<input id="stateName" type="hidden" value="Published"/><input id="hoverDescription" type="hidden" value="Published"/><input id="finalState" type="hidden" value="true"/><input id="hasFinalState" type="hidden" value="true"/><input id="publishedView" type="hidden" value="true"/><input id="taskable" type="hidden" value="false"/><input id="activeTasks" type="hidden" value="0"/><input id="pageAssignable" type="hidden" value="false"/><input id="workflowAdmin" type="hidden" value="false"/><input id="anonymous" type="hidden" value="true"/><input id="alternateViewStateName" type="hidden" value="View"/><input id="alternateViewUrl" type="hidden" value="/display/1101discernHP/CCLIO%28+%29+Using+Discern+Explorer?draft=true"/><input id="activityVisible" type="hidden" value="true"/><input id="approvalMinQuery" type="hidden" value="5"/><input id="showDocumentActivity" type="hidden" value="true"/><input id="alternateViewTitle" type="hidden" value="View latest version of page"/></fieldset></div>
<div style="display: none;"></div>









































<!-- CTSSOL-29742: Add Page To Book -->


<div id="page">
<div id="full-height-container">


<div class="ia-splitter">

<!-- \#header -->
<main class="aui-page-panel" id="main" role="main">
<!-- \#main-header -->
<div id="sidebar-container">
</div><!-- \#sidebar-container -->


<div class="page view" id="content">
<div id="action-messages">
</div>






<div class="wiki-content" id="main-content">
<div class="wiki-content">
<p>CCLIO( ) provides access to streaming input and output (IO) functions.</p><h2 id="CCLIO()UsingDiscernExplorer-Syntax">Syntax</h2><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CCLIO(function_name,record_name)</pre>
</div></div><h2 id="CCLIO()UsingDiscernExplorer-Metasymbols">Metasymbols</h2><p>function_name<br>Defines the type of operation to perform. The function_name must be passed as a string in uppercase. The following are valid function names:</br></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Function Name</p></th><th class="confluenceTh"><p>Description</p></th><th class="confluenceTh"><p>Input/Output/Notes: Depending on the Function_Name That is Specified, the CCLIO() Function Uses Fields in the Record_Name as Input or Output.</p></th><th class="confluenceTh"><p>Return: The CCLIO() Function Returns Different Values Depending on the Function_Name That is Used.</p></th></tr><tr><th class="confluenceTh"><p>"CLOSE"</p></th><td class="confluenceTd"><p>Close the file and commit its contents to disk.</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p><strong>0:</strong> close error <br class="atl-forced-newline"/><strong>1:</strong> close success</p></td></tr><tr><th class="confluenceTh"><p>"EOF"</p></th><td class="confluenceTd"><p>Return end of file.</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p><strong>0:</strong> not end of file <br class="atl-forced-newline"/><strong>1:</strong> end of file reached</p></td></tr><tr><th class="confluenceTh"><p>"ERROR"</p></th><td class="confluenceTd"><p>Return error messages.</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p><strong>0: </strong>error <br class="atl-forced-newline"/><strong>1: </strong>success</p></td></tr><tr><th class="confluenceTh"><p>"FLUSH"</p></th><td class="confluenceTd"><p>Commits file contents to disk.</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p><strong>0:</strong> flush error <br class="atl-forced-newline"/><strong>1:</strong> flush success</p></td></tr><tr><th class="confluenceTh"><p>"GETS"</p></th><td class="confluenceTd"><p>Read from file using a record operation.</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc, record_name-&gt;file_buf)</p></td><td class="confluenceTd"><p><strong>0:</strong> gets error <br class="atl-forced-newline"/><strong>1:</strong> gets success</p></td></tr><tr><th class="confluenceTh"><p>"OPEN"</p></th><td class="confluenceTd"><p>Open the file and set the open mode.</p></td><td class="confluenceTd"><p>The record_name-&gt;file_buf field is used to specify the open mode. Input(record_name-&gt;file_name,<br class="atl-forced-newline"/>record_name-&gt;file_buf)<br class="atl-forced-newline"/>Output(record_name→file_desc)</p><p><span style="text-decoration: underline;">File_buf value: must be passed as a string in lowercase</span></p><p><strong>"r" :</strong> Open text file for read access positioned at start of file.<span style="text-decoration: underline;"><br/></span></p><p><strong>"w" : </strong>Create a text file for write access positioned at start of file.</p><p><strong>"a" : </strong> Open and append to text file positioned at end of file with file created if it does not exist.</p><p><strong>"rb" :</strong> Open binary file for read access positioned at start of file.</p><p><strong>"wb" : </strong>Create binary file for write access positioned at start of file.</p><p><strong>"ab" :</strong> Open and append to binary file positioned at end of file with file created if it does not exist.</p><p><strong>"r+" :</strong> Open text file for read/write access positioned at start of file.</p><p><strong>"w+" :</strong> Create text file for read write access positioned at start of file with file created if it does not exist.</p><p><strong>"a+" :</strong> Open text file for read write access positioned at end of file with file created if it does not exist.</p><p><strong>"rb+" :</strong> Open binary file for read write access positioned at start of file.</p><p><strong>"wb+" :</strong> Create binary file for read write access positioned at start of file with file created if it does not exist.</p><p><strong>"ab+" :</strong> Open binary file for read write access positioned at end of file with file created if it does not exist.</p></td><td class="confluenceTd"><p><strong>0:</strong> open error <br class="atl-forced-newline"/><strong>1:</strong> open success</p></td></tr><tr><th class="confluenceTh"><p>"PUTS"</p></th><td class="confluenceTd"><p>Write to file use a record operation</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc, <br class="atl-forced-newline"/>record_name-&gt;file_buf)</p></td><td class="confluenceTd"><p><strong>0: </strong>puts error <br class="atl-forced-newline"/><strong>1: </strong>puts success</p></td></tr><tr><th class="confluenceTh"><p>"READ"</p></th><td class="confluenceTd"><p>Read entire file</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc) <br class="atl-forced-newline"/>Output( record_name-&gt;file_buf)</p></td><td class="confluenceTd"><p>Number of bytes read</p></td></tr><tr><th class="confluenceTh"><p>"SEEK"</p></th><td class="confluenceTd"><p>Find a location in the file</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc, <br class="atl-forced-newline"/>record_name-&gt;file_offset, <br class="atl-forced-newline"/>record_name-&gt;file_dir) <br class="atl-forced-newline"/><strong>Note: </strong>if record_name-&gt;file_dir is equal to <br class="atl-forced-newline"/><strong>0:</strong> seek record_name-&gt;file_offset from beginning of file <br class="atl-forced-newline"/><strong>1: </strong>seek record_name-&gt;file_offset from current position of file <br class="atl-forced-newline"/><strong>2: </strong>seek record_name-&gt;file_offset from end of file <br class="atl-forced-newline"/>Record_name-&gt;file_offset must be set to a positive number. The Seek operation seeks backwards from the end of the file and forward from the beginning or current location in the file.</p></td><td class="confluenceTd"><p><strong>0: </strong>seek error <br class="atl-forced-newline"/><strong>1:</strong> seek success</p></td></tr><tr><th class="confluenceTh"><p>"SHOW"</p></th><td class="confluenceTd"><p>Shows list of all open file descriptors</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p><strong>0: </strong>show error <br class="atl-forced-newline"/><strong>1: </strong>show success</p></td></tr><tr><th class="confluenceTh"><p>"TELL"</p></th><td class="confluenceTd"><p>Return current position for open file</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc)</p></td><td class="confluenceTd"><p>Current position for open file</p></td></tr><tr><th class="confluenceTh"><p>"WRITE"</p></th><td class="confluenceTd"><p>Write entire file</p></td><td class="confluenceTd"><p>Input(record_name-&gt;file_desc, <br class="atl-forced-newline"/>record_name-&gt;file_buf)</p></td><td class="confluenceTd"><p>Number of bytes written</p></td></tr></tbody></table></div><p>record_name<br/>The name of a record structure that has been previously defined with the following fields at level 1.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh" colspan="1"><p>Name</p></th><th class="confluenceTh"><p>Level</p></th><th class="confluenceTh"><p>Data Type</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><th class="confluenceTh" colspan="1"><p>file_desc</p></th><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>W8 for 64bit environments</p><p>I4 for 32bit environments</p></td><td class="confluenceTd"><p>Unique number set by the CCLIO() function to identify all file handles. The file_desc is saved in a list to check for all CCLIO calls to ensure a valid file handle is passed in for the CCLIO call.</p></td></tr><tr><th class="confluenceTh" colspan="1"><p>file_offset</p></th><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>I4</p></td><td class="confluenceTd"><p>Number of bytes in the file for the Seek operation to look for.</p></td></tr><tr><th class="confluenceTh" colspan="1"><p>file_dir</p></th><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>I4</p></td><td class="confluenceTd"><p>File direction used by the Seek operation. <br class="atl-forced-newline"/>0: seek from beginning of file <br class="atl-forced-newline"/>1: seek from current position of file <br class="atl-forced-newline"/>2: seek from end of file</p></td></tr><tr><th class="confluenceTh" colspan="1"><p>file_name</p></th><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>VC or fixed-length character</p></td><td class="confluenceTd"><div class="content-wrapper"><p>Path and name of a file. If the path is not specified, CCLUSERDIR: is used by default. CCLIO() converts a literal path and filename to lowercase characters. </p><p>In <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> version 8.12.6 and higher, the SET LOGICAL command can be used to specify a mixed or uppercase path and filename. If the mixed or uppercase path and filename used in the SET LOGICAL command exists, it is used. Else, the lowercase path and filename are used.</p></div></td></tr><tr><th class="confluenceTh" colspan="1"><p>file_buf</p></th><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>VC or fixed-length character</p></td><td class="confluenceTd"><p>Buffer that is used for reading or writing.</p></td></tr></tbody></table></div><p>The following RECORD command creates a record structure that meets these requirements:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>RECORD FREC(
     1 FILE_DESC = W8
     1 FILE_OFFSET = I4
     1 FILE_DIR = I4
     1 FILE_NAME = VC
     1 FILE_BUF = VC
   )
</pre>
</div></div><h2 id="CCLIO()UsingDiscernExplorer-Examples">Examples</h2><p>The below example opens a file named ccl_test.dat in the CCLUSERDIR: directory, reads the lines from that file, and closes the file.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>DROP PROGRAM CCL_TEST_CCLIO GO
CREATE PROGRAM CCL_TEST_CCLIO
   DECLARE STAT = I4
   DECLARE POS = I4

   RECORD FREC(
     1 FILE_DESC = W8
     1 FILE_OFFSET = I4
     1 FILE_DIR = I4
     1 FILE_NAME = VC
     1 FILE_BUF = VC
   )
   ;Open a file named CCL_TEST.DAT with read access
   SET FREC-&gt;FILE_NAME = "CCL_TEST.DAT"
   SET FREC-&gt;FILE_BUF = "r" /* file_buf values are case sensitive so lowercase r is used */
   SET STAT = CCLIO("OPEN",FREC)
    ;Allocate buffer for desired read size
   SET FREC-&gt;FILE_BUF = NOTRIM(FILLSTRING(132," "))
   IF (FREC-&gt;FILE_DESC != 0)
       SET STAT = 1
       WHILE (STAT &gt; 0)
	;read the file one record at a time
          SET STAT = CCLIO("GETS",FREC)
          IF (STAT &gt; 0)
              SET POS = FINDSTRING(CHAR(0),FREC-&gt;FILE_BUF)
              SET POS = EVALUATE(POS,0,SIZE(FREC-&gt;FILE_BUF),POS)
              CALL ECHO(SUBSTRING(1,POS,FREC-&gt;FILE_BUF))
          ENDIF
       ENDWHILE
        ;Close the file
       SET STAT = CCLIO("CLOSE",FREC)
   ENDIF
   CALL ECHORECORD(FREC)
END GO
</pre>
</div></div><p>The below example opens a file named ccl_file.dat. If the file does not already exist, it is created. A SELECT command is used to select information from the Person table. That information is built into a comma-separated string with text values embedded in double quotation marks, and a carriage return and linefeed character at the end. That string is written to the file and then the file is closed.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>drop program cclio_exam go
create program cclio_exam

RECORD FREC(
     1 FILE_DESC = W8
     1 FILE_OFFSET = I4
     1 FILE_DIR = I4
     1 FILE_NAME = VC
     1 FILE_BUF = VC
   )

;Open a file named ccl_file.dat with write access
SET FREC-&gt;FILE_NAME = "ccl_file.dat"
SET FREC-&gt;FILE_BUF = "w"   
SET STAT = CCLIO("OPEN",FREC)

;select person information 
SELECT INTO "nl:"
    p.PERSON_ID
    , p.NAME_FULL_FORMATTED
    , P_SEX_DISP = UAR_GET_CODE_DISPLAY(P.SEX_CD)
    , UPDT_DT_TM = FORMAT(p.UPDT_DT_TM,"DD-MMM-YYYY HH:MM:SS;;D")
FROM
    PERSON   P
WHERE P.UPDT_DT_TM BETWEEN CNVTLOOKBEHIND("1,D") AND CNVTDATETIME(CURDATE, CURTIME3)
    AND P.NAME_FULL_FORMATTED &gt; " "
    AND P.SEX_CD &gt; 0.0
HEAD REPORT
    ROW +0
    FREC-&gt;FILE_BUF  = " "
DETAIL
    ;create a comma separated string with text values embedded in double quotes
    FREC-&gt;FILE_BUF = BUILD(P.PERSON_ID, ^,"^
                ,P.NAME_FULL_FORMATTED, ^","^
                ,P_SEX_DISP, ^","^
                ,UPDT_DT_TM, ^"^
                ,CHAR(13)  ;add carriage return
                ,CHAR(10)) ;and linefeed character to end of the string
    ;write the string to the file
    STAT = CCLIO("PUTS",FREC)
FOOT REPORT
    ;close the file
    STAT = CCLIO("CLOSE",FREC)
WITH NOCOUNTER

END GO</pre>
</div></div><p>The below example attempts to create a file named case_file.dat in the /cerner/d_cert/ccluserdir/temp directory. The uppercase characters in the path and filename are converted to lowercase characters by default.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>set frec-&gt;file_name = "/cerner/d_cert/ccluserdir/TEMP/Case_file.dat" 
set frec-&gt;file_buf = "w+"   ;file open mode
set stat = cclio("OPEN",frec)</pre>
</div></div><p>The below example uses the SET LOGICAL command attempting to create a file in a path that uses uppercase characters. Using <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> version 8.12.6 or higher, the file is created in /cerner/d_cert/ccluserdir/TEMP/ if that directory exists. If the directory does not exist, <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> searches for a /cerner/d_cert/ccluserdir/temp directory and creates the file there if it exists.  Before <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> version 8.12.6, the file is created in the /cerner/d_cert/ccluserdir/temp directory if it exists.  </p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>set logical tdir "/cerner/d_cert/ccluserdir/TEMP/Case_file.dat" 
set frec-&gt;file_name = "tdir"
set frec-&gt;file_buf = "w+"   ;file open mode
set stat = cclio("OPEN",frec)</pre>
</div></div>
</div>
</div>



</div>

</main><!-- \#main -->
</div>
</div>
</div><!-- \#full-height-container -->
<!-- \#page -->
<span id="confluence-server-performance" style="display:none;">{"serverDuration": 601, "requestCorrelationId": "301a7e99f15c84ab"}</span>
</body>
</html>


<!DOCTYPE html>

<html lang="en-US">
<head>
<!-- Start SiteCatalyst code --><!-- End SiteCatalyst code -->


<title>CNVTNLSSORT Using Discern Explorer - Discern Help Pages - Cerner Wiki</title>






























<style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>



</head>
<body class="theme-default aui-layout aui-theme-default" id="com-atlassian-confluence">
<div id="stp-licenseStatus-banner"></div>
<div id="workflow-page-status" style="display: none;"><fieldset class="hidden parameters">
<input id="stateName" type="hidden" value="Published"/><input id="hoverDescription" type="hidden" value="Published"/><input id="finalState" type="hidden" value="true"/><input id="hasFinalState" type="hidden" value="true"/><input id="publishedView" type="hidden" value="true"/><input id="taskable" type="hidden" value="false"/><input id="activeTasks" type="hidden" value="0"/><input id="pageAssignable" type="hidden" value="false"/><input id="workflowAdmin" type="hidden" value="false"/><input id="anonymous" type="hidden" value="true"/><input id="alternateViewStateName" type="hidden" value="View"/><input id="alternateViewUrl" type="hidden" value="/display/1101discernHP/CNVTNLSSORT+Using+Discern+Explorer?draft=true"/><input id="activityVisible" type="hidden" value="true"/><input id="approvalMinQuery" type="hidden" value="5"/><input id="showDocumentActivity" type="hidden" value="true"/><input id="alternateViewTitle" type="hidden" value="View latest version of page"/></fieldset></div>
<div style="display: none;"></div>









































<!-- CTSSOL-29742: Add Page To Book -->


<div id="page">
<div id="full-height-container">


<div class="ia-splitter">

<!-- \#header -->
<main class="aui-page-panel" id="main" role="main">
<!-- \#main-header -->
<div id="sidebar-container">
</div><!-- \#sidebar-container -->


<div class="page view" id="content">
<div id="action-messages">
</div>






<div class="wiki-content" id="main-content">
<div class="wiki-content">
<p>The CNVTNLSSORT() function provides use of national language support (NLS) for qualifications and sorting in non-English locales. NLS accounts for differences in character sets and sort orders between English and other languages. Additionally NLS can provide accent and case insensitivity for qualifications and sorting in non-English locales. CNVTNLSSORT() function returns the nlssort value for the expression in non-English locales but is ignored (treated as no operation) in English locales.</p><p>Some columns that are often used in qualifications and sorting have corresponding NLS columns. Qualifications on those columns may provide an implicit conversion to use the NLS columns. For example, the PERSON table contains a NAME_LAST_KEY field and the corresponding NAME_LAST_KEY_NLS and NAME_LAST_KEY_A_NLS columns. Database triggers populate the _NLS and _A_NLS fields in non-English environments. Qualifying on the NAME_LAST_KEY column will implicitly convert to use the NAME_LAST_KEY_A_NLS or NAME_LAST_KEY_NLS field in non-English environments.</p><p><span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> Version 8.7.2 introduced the ability to use CNVTNLSSORT() function in the ORDER [BY] clause. No implicit conversion to use the NLS columns will be performed on fields used in the ORDER [BY] clause. Explicitly use the CNVTNLSSORT() function to have the results sorted using NLS. The CNVTNLSSORT() function does not implicitly perform the NLS sort using the _A_NLS field.  The CNVTNLS() function can be embedded within the CNVTNLSSORT() function to provide NLS sorting using the _A_NLS field.</p><p><span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> Version 8.10.3 applied an implicit conversion to use NLS columns when a corresponding non-NLS column was used in the ORDER [BY] clause; however, this change caused some nonpassive issues and was removed in <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> Version 8.10.4.</p><h2 id="CNVTNLSSORTUsingDiscernExplorer-Syntax">Syntax</h2><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(expr[,mode[,sort_name]])
</pre>
</div></div><h2 id="CNVTNLSSORTUsingDiscernExplorer-Metasymbol">Metasymbol</h2><p><em>expr</em><br>Any character expression.</br></p><p><em>mode</em></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><p>Mode</p></th><th class="confluenceTh"><p>Description</p></th></tr><tr><td class="confluenceTd"><p>0</p></td><td class="confluenceTd"><p>Strip out special characters (default for non-accent domains).</p></td></tr><tr><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>Do not strip out special characters (default for accent domains).</p></td></tr></tbody></table></div><p><em>sort_name</em><br/>Sort name to use for linguistic compare that includes language and case insensitive (_CI) or accent and case insensitive (_AI).</p><h2 id="CNVTNLSSORTUsingDiscernExplorer-Examples">Examples</h2><p>The following example returns the nlssort value for the p.name_full_formatted field:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(P.NAME_FULL_FORMATTED)</pre>
</div></div><p>The following example returns the nlssort value for the p.name_last_key field. Special characters are removed; French language sorting with both accent and case insensitivity is used.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(P.NAME_LAST_KEY,0,"FRENCH_AI")</pre>
</div></div><p>The following example returns the nlssort value for the p.name_last_key field. Special characters are removed; French language sorting with accent sensitivity and case insensitivity is used.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(P.NAME_LAST_KEY,0,"FRENCH_CI")</pre>
</div></div><p>The following example returns the nlssort value for the p.name_last_key field. Special characters are removed; French language sorting with both accent and case insensitivity is used.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(P.NAME_LAST_KEY,1,"FRENCH_AI")</pre>
</div></div><p>The following example would return the nlssort value for the p.name_last_key field. Special characters are not removed; French language sorting with accent sensitivity and case insensitivity is used.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>CNVTNLSSORT(P.NAME_LAST_KEY,1,"FRENCH_CI")  ;dont strip special char, french case insensitive</pre>
</div></div><p>The following example uses SET TRACE RDBDEBUG to see how the <span class="conf-solution-name conf-macro output-inline" data-hasbody="false" data-macro-name="solution">Discern Explorer</span> query is passed to the RDBMS:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>set trace rdbdebug go
 
select into "NL:" p.name_last_key
	,p.name_first_key
from person p
where p.name_last_key between "PER" and "PERZ"
order by p.name_last_key
go
</pre>
</div></div><p>When executed in a non-English domain, the above query was converted to the following syntax and was passed to the RDBMS:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>RDB
 SELECT  P.NAME_LAST_KEY,
      P.NAME_FIRST_KEY 
FROM  PERSON P  
WHERE P.NAME_LAST_KEY_A_NLS BETWEEN  CERN_NLS_SORT( :1   , 'NLS_SORT=FRENCH_AI') 
       AND  CERN_NLS_SORT( :2   ,'NLS_SORT=FRENCH_AI') 
ORDER BY  P.NAME_LAST_KEY
GO
</pre>
</div></div><p>Note the implicit conversion to use the NAME_LAST_KEY_A_NLS column in the WHERE clause, but the ORDER BY clause is using the NAME_LAST_KEY column.</p><p>In other domains using different locale settings, a different query could be sent to the RDBMS to use the NLS for that domain.</p><p>The following example explicitly uses the CNVTNLSSORT() function in the ORDER BY clause:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>set trace rdbdebug go
 
select into "NL:" p.name_last_key
	,p.name_first_key
from person p
where p.name_last_key between "PER" and "PERZ"
order by cnvtnlssort(p.name_last_key)
go
</pre>
</div></div><p>When executed in a non-English domain, the above query was converted to the following syntax, which was passed to the RDBMS:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>RDB
 SELECT  P.NAME_LAST_KEY,
      P.NAME_FIRST_KEY 
FROM  PERSON P  
WHERE P.NAME_LAST_KEY_A_NLS BETWEEN  CERN_NLS_SORT( :1   , 'NLS_SORT=FRENCH_AI') 
       AND  CERN_NLS_SORT( :2   ,'NLS_SORT=FRENCH_AI') 
ORDER BY  CERN_NLS_SORT(P.NAME_LAST_KEY, 'NLS_SORT=FRENCH_AI') 
GO
</pre>
</div></div><p>Notice that the above query is using the P.NAME_LAST_KEY  field for the NLS sort. The following example explicitly embeds the CNVTNLS() function the CNVTNLSSORT() to explicitly force using the P.NAME_LAST_KEY_A_NLS field to be used for the NLS sort:</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>set trace rdbdebug go
 
select into "NL:" p.name_last_key
	,p.name_first_key
from person p
where p.name_last_key between "PER" and "PERZ"
order by cnvtnlssort(cnvtnls(p.name_last_key))
go
</pre>
</div></div><p>When executed in a non-English domain the above query was converted to the following syntax, which was passed to the RDBMS.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>RDB
 SELECT  P.NAME_LAST_KEY,
      P.NAME_FIRST_KEY 
FROM  PERSON P  
WHERE P.NAME_LAST_KEY_A_NLS BETWEEN  CERN_NLS_SORT( :1   , 'NLS_SORT=FRENCH_AI') 
       AND  CERN_NLS_SORT( :2   ,'NLS_SORT=FRENCH_AI') 
ORDER BY  CERN_NLS_SORT(P.NAME_LAST_KEY_A_NLS, 'NLS_SORT=FRENCH_AI') 
GO</pre>
</div></div><p>In other domains using different locale settings, a different query could be sent to the RDBMS to use the NLS for that domain.</p><p>When executed in an English domain, the above query is converted to the syntax below and is passed to the RDBMS. Notice the NAME_LAST_KEY column is used in both the WHERE clause and the ORDER BY clause.</p><div class="preformatted panel conf-macro output-block" data-hasbody="true" data-macro-name="noformat"><div class="preformattedContent panelContent">
<pre>RDB
 SELECT   P.NAME_LAST_KEY,
      P.NAME_FIRST_KEY 
FROM  PERSON P  
WHERE P.NAME_LAST_KEY BETWEEN  :1    AND  :2  
ORDER BY P.NAME_LAST_KEY 
GO
</pre>
</div></div>
</div>
</div>



</div>

</main><!-- \#main -->
</div>
</div>
</div><!-- \#full-height-container -->
<!-- \#page -->
<span id="confluence-server-performance" style="display:none;">{"serverDuration": 748, "requestCorrelationId": "e90a99ce30dd022d"}</span>
</body>
</html>
